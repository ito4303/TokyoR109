---
title: "Rootogramã§ãƒ¢ãƒ‡ãƒ«ã®ã‚ã¦ã¯ã¾ã‚Šã‚’è©•ä¾¡"
author: "ä¼Šæ±å®æ¨¹"
date: 2023-10-07
format:
  revealjs:
    theme: [default, custom.scss]
editor: visual
self-contained: true
---

## è‡ªå·±ç´¹ä»‹

-   æ°å: ä¼Šæ±å®æ¨¹
-   å°‚é–€: æ£®æ—ç”Ÿæ…‹å­¦
-   å…±è¨³æ›¸: ã€[BUGSã§å­¦ã¶éšå±¤ãƒ¢ãƒ‡ãƒªãƒ³ã‚°å…¥é–€](https://www.hanmoto.com/bd/isbn/9784320057807)ã€ã€[ç”Ÿæ…‹å­¦ã®ãŸã‚ã®éšå±¤ãƒ¢ãƒ‡ãƒªãƒ³ã‚°](https://www.hanmoto.com/bd/isbn/9784320058149)ã€ãªã©
-   åˆ†æ‹…åŸ·ç­†: ã€[å²©æ³¢ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ Vol.1](https://www.hanmoto.com/bd/isbn/9784000298513)ã€ã€[å²©æ³¢ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ Vol.6](https://www.hanmoto.com/bd/isbn/9784000298568)ã€ã€[ãŸã®ã—ã„ãƒ™ã‚¤ã‚ºãƒ¢ãƒ‡ãƒªãƒ³ã‚°2](https://www.hanmoto.com/bd/isbn/9784762830839)ã€ãªã©

## Rootogram

-   é›¢æ•£å€¤ãƒ‡ãƒ¼ã‚¿ã®ã‚ã¦ã¯ã¾ã‚Šåº¦åˆã„ã‚’å¯è¦–åŒ–

-   è«–æ–‡: Kleiber, C. and Zeileis, A. (2016) Visualizing count data regressions using rootograms. The American Statistician. 70(3): 296--303. <https://arxiv.org/abs/1605.01311>.

## bayesplot::ppc_rootogram()

::: {style="margin-top: 1em;"}
bayesplotãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã€äº‹å¾Œäºˆæ¸¬æ¤œæŸ» (Posterior predictive check) ã®ã²ã¨ã¤ã¨ã—ã¦RootogramãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã€‚
:::

## ä½¿ã„æ–¹

```{r}
#| eval: false
#| echo: true
#| code-overflow: wrap
ppc_rootogram(y, yrep,
              style = c("standing",
                        "hanging",
                        "suspended"))
```

-   y: è¦³æ¸¬å€¤
-   yrep: äº‹å¾Œäºˆæ¸¬åˆ†å¸ƒã‹ã‚‰ã®è¤‡è£½ãƒ‡ãƒ¼ã‚¿
-   style: ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆã“ã®ã‚ã¨èª¬æ˜ï¼‰

## style = "standing"

![](figures/standing.png)

## style = "hanging"

![](figures/hanging.png)

## style = "suspended"

![](figures/suspended.png)

## è¤‡è£½ãƒ‡ãƒ¼ã‚¿ã®ã¤ãã‚Šã‹ãŸ

Stanã®å ´åˆ

``` stan
model {
  Y ~ poisson(lambda);
}
generated quantities {
  array[n] int yrep;
  for (n in 1:N)
    yrep[n] = poisson_rng(lambda);
}
```

------------------------------------------------------------------------

BUGSã®å ´åˆ

``` r
for (n in 1:N) {
  Y[n] ~ dpois(lambda)
  yrep[n] ~ dpois(lambda)
}
```

## ã¾ã¨ã‚

Rootogramã§ã€é›¢æ•£å€¤ã‚’ç›®çš„å¤‰æ•°ã¨ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ãŒãƒ‡ãƒ¼ã‚¿ã«ã†ã¾ãã‚ã¦ã¯ã¾ã£ã¦ã„ã‚‹ã‹ã‚’è¦–è¦šçš„ã«è©•ä¾¡ã§ãã‚‹ã€‚

::: {style="margin-top: 1em; text-align:center; font-size: 300%;"}
ğŸ¥³
:::
